# Vision Tokenizer Benchmark - Discrete Tokenizers Only
#
# Discrete tokenizationì— ì§‘ì¤‘í•œ ì„¤ì •
# TA-Tok, AR-DTok, SANA, Lumina2, VQ-GAN ë“±

# ì‹¤í–‰ í™˜ê²½ ì„¤ì •
device: cuda  # cuda or cpu
use_multi_gpu: true  # Enable multi-GPU processing (if available)
output_dir: results/discrete_tokenizers
seed: 42

# ë°ì´í„°ì…‹ ì„¤ì •
dataset:
  name: coco
  root: data/coco
  split: val
  year: 2017
  num_samples: 10
  image_size: [512, 512]  # ëª¨ë“  ëª¨ë¸ì„ 512pxë¡œ í†µì¼

# Discrete Tokenizers
tokenizers:
  # ========================================
  # 1. TA-Tok + De-Tokenizers (ëª¨ë‘ ìë™ ë‹¤ìš´ë¡œë“œ âœ…)
  # ========================================
  # TA-Tok: ì¸ì½”ë” (ì´ë¯¸ì§€ â†’ í† í°)
  # De-Tokenizer: ë””ì½”ë” (í† í° â†’ ì´ë¯¸ì§€)
  #   - AR-DTok: Autoregressive (256/512/1024px)
  #   - SANA Dif-DTok: Diffusion (512/1024px)
  #   - Lumina2 Dif-DTok: Diffusion (1024px) ğŸŒŸ ê¶Œì¥
  
  # Note: TA-Tokê³¼ De-Tokenizerë¥¼ ì¡°í•©í•˜ì—¬ ì‚¬ìš©
  # âœ… ë¡œì»¬ ì²´í¬í¬ì¸íŠ¸ ì‚¬ìš© (model_weights/ta_tok.pth)
  # âœ… Tar í”„ë¡œì íŠ¸ ì½”ë“œ í†µí•© ì™„ë£Œ
  # ğŸ“Œ ê° De-TokenizerëŠ” í•´ìƒë„ë³„ ëª¨ë¸ ì œê³µ (256px, 512px, 1024px)
  
  # ========================================
  # 1-1. TA-Tok + AR-DTok (Autoregressive)
  # ========================================
  
  # AR-DTok 512px âœ… ê¸°ë³¸ í…ŒìŠ¤íŠ¸
  - name: tatok_ardtok_512
    type: tatok_ardtok
    ta_tok_checkpoint: model_weights/ta_tok.pth
    ar_dtok_size: 512
    description: "TA-Tok + AR-DTok (AR, 512px)"
  
  # ========================================
  # 1-2. TA-Tok + SANA Dif-DTok (Diffusion)
  # ========================================
  
  # SANA 512px âœ… ê¸°ë³¸ í…ŒìŠ¤íŠ¸
  - name: tatok_sana_512
    type: tatok_sana
    ta_tok_checkpoint: model_weights/ta_tok.pth
    sana_model: csuhan/Tar-SANA-600M-512px
    description: "TA-Tok + SANA Dif-DTok (Diffusion, 512px)"
  
  
  # ========================================
  # 1-3. TA-Tok + Lumina2 Dif-DTok (Diffusion) ğŸŒŸ
  # ========================================
  
  # Lumina2 1024px â†’ 512px ë¦¬ì‚¬ì´ì¦ˆ âœ…
  - name: tatok_lumina2_512
    type: tatok_lumina2
    ta_tok_checkpoint: model_weights/ta_tok.pth
    lumina2_model: csuhan/Tar-Lumina2
    output_size: 512
    description: "TA-Tok + Lumina2 Dif-DTok (Diffusion, 1024pxâ†’512px) ğŸŒŸ Best Quality"
  
  # ========================================
  # 2. Open-MAGVIT2 (Lookup Free Quantization)
  # ========================================
  # Open-MAGVIT2ëŠ” LFQë¥¼ ì‚¬ìš©í•˜ì—¬ ë§¤ìš° íš¨ìœ¨ì ì¸ tokenization ì œê³µ
  # ìë™ ë‹¤ìš´ë¡œë“œ: TencentARC/Open-MAGVIT2
  
  # Open-MAGVIT2 256px âœ… (ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©)
  - name: magvit2_256
    type: magvit2
    image_size: 256
    codebook_size: 262144  # 18-bit
    description: "Open-MAGVIT2 with LFQ (256px, codebook=262144)"
  
  # ========================================
  # 3. TiTok (1D Latent Tokenization)
  # ========================================
  # TiTokì€ ê·¹ë„ë¡œ ì••ì¶•ëœ í‘œí˜„ ì‚¬ìš© (32 tokens for 256x256)
  # ìë™ ë‹¤ìš´ë¡œë“œ: fun-research/TiTok
  
  # TiTok-L-32 256px âœ… (ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©)
  - name: titok_l32_256
    type: titok
    image_size: 256
    num_latent_tokens: 32
    codebook_size: 4096
    model_name: "yucornetto/tokenizer_titok_l32_imagenet"
    description: "TiTok-L-32: An Image is Worth 32 Tokens (256px)"
  
  # ========================================
  # 4. VAE + Quantization (Baseline)
  # ========================================
  
  # SD VAE - MSE + Quantization (8bit) âœ… ê¸°ë³¸ í…ŒìŠ¤íŠ¸
  - name: vae_sd_mse_q8_512
    type: vae
    model_name: stabilityai/sd-vae-ft-mse
    use_quantization: true
    num_quantization_bins: 256
    description: "SD VAE MSE with 8-bit quantization (512px, baseline)"


# í‰ê°€ ë©”íŠ¸ë¦­ ì„¤ì •
metrics:
  reconstruction:
    - psnr
    - ssim
    - lpips
    - ms_ssim
    - mae
    - rmse
    - fid  # FrÃ©chet Inception Distance
  
  token_stats:
    - bpp
    - codebook_entropy
    - codebook_usage
    - compression_ratio
    - token_diversity

# ì¶œë ¥ ì„¤ì •
output:
  save_reconstructions: true
  save_tokens: false
  save_format: both  # csvì™€ parquet ëª¨ë‘
  generate_visualizations: true
  visualization_samples: 10

# ì„±ëŠ¥ ì„¤ì •
performance:
  batch_size: 1
  num_workers: 4
  pin_memory: true

# ë¡œê¹… ì„¤ì •
logging:
  level: INFO
  log_file: results/discrete_tokenizers/benchmark.log
  progress_bar: true