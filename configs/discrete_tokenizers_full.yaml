# Vision Tokenizer Benchmark - Discrete Tokenizers (Full Validation Set)
#
# COCO validation set ì „ì²´ (5000 images)ì— ëŒ€í•œ ë²¤ì¹˜ë§ˆí¬
# ì •í™•í•œ ì„±ëŠ¥ í‰ê°€ë¥¼ ìœ„í•œ ì„¤ì •

# ì‹¤í–‰ í™˜ê²½ ì„¤ì •
device: cuda  # cuda or cpu
use_multi_gpu: true  # Enable multi-GPU processing (if available)
output_dir: results/discrete_tokenizers_full
seed: 42

# ë°ì´í„°ì…‹ ì„¤ì •
dataset:
  name: coco
  root: data/coco
  split: val
  year: 2017
  num_samples: 1000  
  image_size: [512, 512]  # ëª¨ë“  ëª¨ë¸ì„ 512pxë¡œ í†µì¼

# Discrete Tokenizers
tokenizers:
  # ========================================
  # 1. TA-Tok + De-Tokenizers (ëª¨ë‘ ìë™ ë‹¤ìš´ë¡œë“œ âœ…)
  # ========================================
  # TA-Tok: ì¸ì½”ë” (ì´ë¯¸ì§€ â†’ í† í°)
  # De-Tokenizer: ë””ì½”ë” (í† í° â†’ ì´ë¯¸ì§€)
  #   - AR-DTok: Autoregressive (256/512/1024px)
  #   - SANA Dif-DTok: Diffusion (512/1024px)
  #   - Lumina2 Dif-DTok: Diffusion (1024px) ğŸŒŸ ê¶Œì¥
  
  # ========================================
  # 1-1. TA-Tok + AR-DTok (Autoregressive)
  # ========================================
  
  # AR-DTok 512px âœ…
  - name: tatok_ardtok_512
    type: tatok_ardtok
    ta_tok_checkpoint: model_weights/ta_tok.pth
    ar_dtok_checkpoint: csuhan/TA-Tok
    output_size: 512
    enabled: true
    description: "TA-Tok + AR-DTok (AR, 512px)"
  
  # ========================================
  # 1-2. TA-Tok + SANA Dif-DTok (Diffusion)
  # ========================================
  
  # SANA 512px âœ…
  - name: tatok_sana_512
    type: tatok_sana
    ta_tok_checkpoint: model_weights/ta_tok.pth
    sana_model: csuhan/Tar-SANA-600M-512px
    output_size: 512
    enabled: true
    description: "TA-Tok + SANA Dif-DTok (Diffusion, 512px)"
  
  
  # ========================================
  # 1-3. TA-Tok + Lumina2 Dif-DTok (Diffusion) ğŸŒŸ
  # ========================================
  
  # Lumina2 1024px â†’ 512px ë¦¬ì‚¬ì´ì¦ˆ âœ…
  - name: tatok_lumina2_512
    type: tatok_lumina2
    ta_tok_checkpoint: model_weights/ta_tok.pth
    lumina2_model: csuhan/Tar-Lumina2
    output_size: 512
    enabled: true
    description: "TA-Tok + Lumina2 Dif-DTok (Diffusion, 1024pxâ†’512px) ğŸŒŸ Best Quality"
  
  # ========================================
  # 2. Open-MAGVIT2 (Lookup Free Quantization)
  # ========================================
  # ìë™ ë‹¤ìš´ë¡œë“œ: TencentARC/Open-MAGVIT2
  
  # Open-MAGVIT2 256px âœ… (ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©)
  - name: magvit2_256
    type: magvit2
    model_name: TencentARC/Open-MAGVIT2
    image_size: 256
    codebook_size: 262144  # 18-bit
    enabled: true
    description: "Open-MAGVIT2 with LFQ (256px, codebook=262144)"
  
  # ========================================
  # 3. TiTok (1D Latent Tokenization)
  # ========================================
  # ìë™ ë‹¤ìš´ë¡œë“œ: fun-research/TiTok
  
  # TiTok-L-32 256px âœ… (ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©)
  - name: titok_l32_256
    type: titok
    image_size: 256
    num_latent_tokens: 32
    codebook_size: 4096
    model_name: yucornetto/tokenizer_titok_l32_imagenet
    enabled: true
    description: "TiTok-L-32: An Image is Worth 32 Tokens (256px)"
  
  # ========================================
  # 4. VAE + Quantization (Baseline)
  # ========================================
  
  # SD VAE - MSE + Quantization (8bit) âœ…
  - name: vae_sd_mse_q8_512
    type: vae
    model_name: stabilityai/sd-vae-ft-mse
    image_size: 512
    quantize_bits: 8
    enabled: true
    description: "SD VAE MSE with 8-bit quantization (512px, baseline)"


# í‰ê°€ ë©”íŠ¸ë¦­ ì„¤ì •
metrics:
  reconstruction:
    - psnr
    - ssim
    - lpips
    - mae
    - rmse
    - fid  # FrÃ©chet Inception Distance

# ì¶œë ¥ ì„¤ì •
output:
  save_reconstructions: true  # ì¬êµ¬ì„± ì´ë¯¸ì§€ ì €ì¥ (5000ê°œ * 6 ëª¨ë¸ = 30000 ì´ë¯¸ì§€)
  save_tokens: false
  save_format: both  # csvì™€ parquet ëª¨ë‘
  generate_visualizations: true
  visualization_samples: 100  # ì‹œê°í™”ì— ì‚¬ìš©í•  ìƒ˜í”Œ ìˆ˜

# ì„±ëŠ¥ ì„¤ì •
performance:
  batch_size: 1
  num_workers: 4
  pin_memory: true

# ë¡œê¹… ì„¤ì •
logging:
  level: INFO
  log_file: results/discrete_tokenizers_full/benchmark.log
  progress_bar: true

